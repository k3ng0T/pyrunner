<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Python Terminal Server</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        body {
            background-color: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Consolas', monospace;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        header {
            background: #333;
            padding: 10px;
            display: flex;
            gap: 10px;
            border-bottom: 1px solid #444;
        }
        button {
            background: #0e639c;
            color: white;
            border: none;
            padding: 5px 15px;
            cursor: pointer;
            font-size: 14px;
        }
        button.stop { background: #a10000; }
        .main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        .editor, .terminal-container {
            width: 50%;
            display: flex;
            flex-direction: column;
            padding: 10px;
            box-sizing: border-box;
        }
        .editor textarea {
            width: 100%;
            height: 100%;
            background: #252526;
            color: #9cdcfe;
            border: none;
            resize: none;
            outline: none;
            font-family: inherit;
            font-size: 16px;
            padding: 10px;
        }
        .terminal-window {
            flex: 1;
            background: #000;
            border: 1px solid #444;
            overflow-y: auto;
            padding: 10px;
            white-space: pre-wrap;
            font-size: 15px;
            color: #cccccc;
        }
        .input-line {
            display: flex;
            background: #000;
            border: 1px solid #444;
            border-top: none;
            padding: 5px;
        }
        .input-line span {
            color: #0f0;
            margin-right: 5px;
        }
        .input-line input {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            outline: none;
            font-family: inherit;
            font-size: 15px;
        }
    </style>
</head>
<body>

<header>
    <strong>LOCAL PYTHON SERVER</strong>
    <button onclick="runCode()">▶ RUN</button>
    <button class="stop" onclick="stopCode()">⏹ STOP</button>
</header>

<div class="main">
    <div class="editor">
        <div style="margin-bottom:5px">main.py</div>
        <textarea id="code" spellcheck="false">
import time

name = input("Введите ваше имя: ")
print(f"Привет, {name}!")

print("Начинаю отсчет...")
for i in range(1, 6):
    print(f"Секунда {i}")
    time.sleep(1)

print("Готово!")
        </textarea>
    </div>
    
    <div class="terminal-container">
        <div style="margin-bottom:5px">Terminal</div>
        <div id="terminal" class="terminal-window"></div>
        <div class="input-line">
            <span>>>></span>
            <input type="text" id="term-input" placeholder="Ввод данных здесь..." autocomplete="off">
        </div>
    </div>
</div>

<script>
    const socket = io();
    const terminal = document.getElementById('terminal');
    const termInput = document.getElementById('term-input');

    // Получение вывода от сервера
    socket.on('terminal_output', function(msg) {
        terminal.innerText += msg.text;
        terminal.scrollTop = terminal.scrollHeight; // Автопрокрутка вниз
    });

    // Запуск кода
    function runCode() {
        const code = document.getElementById('code').value;
        terminal.innerText = "=== Запуск процесса ===\n";
        socket.emit('run_code', {code: code});
        termInput.focus();
    }

    // Остановка кода
    function stopCode() {
        socket.emit('stop_code');
    }

    // Отправка ввода (Enter)
    termInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            const text = termInput.value;
            // Показываем в терминале, что мы ввели
            terminal.innerText += text + "\n";
            // Отправляем на сервер
            socket.emit('send_input', {input: text});
            termInput.value = '';
        }
    });
</script>

</body>
</html>